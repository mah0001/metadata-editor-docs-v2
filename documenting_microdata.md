# Documenting microdata

## Defining microdata ##

When surveys or censuses are conducted, when administrative data are recorded, information is collected on each unit of observation. The unit of observation can be a person, a household, a firm, an agricultural holding, a facility, or other. **Microdata** are the data files resulting from these data collection activities, which contain the unit-level information (as opposed to aggregated data in the form of counts, means, or other). Information on each unit is stored in variables, which can be of different types (e.g. numeric or alphanumeric, discrete or continuous). These variables may contain data reported by the respondent (e.g., the marital status of a person), obtained by observation or measurement (e.g., the GPS location of a dwelling), or generated by calculation, recoding or derivation (e.g., the sample weight in a survey).

For efficiency reasons, variables are often stored in numeric format (i.e. coded values), even when they contain qualitative information (coded values). For example, the sex of a respondent may be stored in a variable named ‘Q_01’, and include values 1, 2 and 9 where 1 represents “male”, 2 represents “female”, and 9 represents “unreported”. Microdata must therefore be provided at a minimum with a data dictionary containing the variables and value labels and, for derived variables, information of the derivation process. But many other features of a micro-dataset should also be described such as the objectives and the methodology of data collection (including a description of the sampling design for sample surveys), the period of data collection, the identification of the primary investigator and other contributors, the scope and geographic coverage of the data, and much more. This information will make the data usable and discoverable.

## Metadata standards

### DDI Codebook for documenting the dataset

The Data Documentation Initiative (DDI) metadata standard provides a structured and comprehensive list of hundreds of elements and attributes which may be used to document microdata. It is unlikely that any one study would ever require using them all, but this list provides a convenient solution to foster completeness of the information, and to generate documentation that will meet the needs of users.

The Data Documentation Initiative (DDI) metadata standard originated in the Inter-university Consortium for Political and Social Research (ICPSR), a membership-based organization with more than 500 member colleges and universities worldwide. The DDI is now the project of an alliance of North American and European institutions. Member institutions comprise many of the largest data producers and data archives in the world. The DDI standard is used by a large community of data archivists, including data librarians from academia, data managers in national statistical agencies and other official data producing agencies, and international organizations. The standard has two branches: the DDI-Codebook (version 2.x) and the DDI LifeCycle (version 3.x). These two branches serve different purposes and audiences. For the purpose of data archiving and cataloguing, the schema we recommend in this Guide is the DDI-Codebook. We use a slightly simplified version of version 2.5 of the standard, to which we add a few elements.

The DDI Alliance developed the DDI-Codebook for organizing the content, presentation, transfer, and preservation of metadata in the social and behavioral sciences. It enables documenting microdata files in a simultaneously flexible and rigorous way. The DDI-Codebook aims to provide a straightforward means of recording and communicating all the salient characteristics of a micro-dataset.

The DDI-Codebook is designed to encompass the kinds of data resulting from surveys, censuses, administrative records, experiments, direct observation and other systematic methodology for generating empirical measurements. The unit of observation can be individual persons, households, families, business establishments, transactions, countries or other subjects of scientific interest.

The DDI Alliance publishes the DDI-Codebook as an XML schema. We present in this Guide a JSON implementation of the schema, which is used in our R package NADAR and Python Library PyNADA. The NADA cataloguing application works with both the XML and the JSON version. A DDI-compliant metadata file can be converted from the JSON schema to the XML or from XML to JSON.

The DDI standard is published under the terms of the [GNU General Public License]((http://www.gnu.org/licenses) (version 3 or later).

### Dublin Core for documenting external resources

For documenting external resources, a template based on the Dublin Core standard is used. See sections **General instructions** and **External resources**.

## Before you start

Before you start documenting a dataset, it is highly recommended to prepare the data and the related materials.

- **Prepare your data files**
   - ***Variable and value labels***: Ensure that all variables and values are labeled (if the data are stored in Stata, SPSS, or another application that loows documentation of variables)
   - ***Direct identifiers***:Drop the direct identifiers from the dataset (names, phone number of respondents, addresses, social security numbers, etc) if you plan to share the data. 
   - ***Unique identifiers and relationships***: Check that each observation in each data file has one or a combination of variables that provide a unique identifier for each observation. Ensure that there are no duplicated identifiers of observations. If your dataset is composed of multiple related data files, check that the files can be merged without any issue. For example, if you have data files at the household and individual levels, make sure all households have at least one corresponding individual, and that each individual belongs to one and only one household.
   - ***Missing values***: Use system missing values (instead of values like '999') for indicating missing values. 
   - ***Work variables***: Drop all temporary or working variables that do not need to be part of the data.  
   - ***Weighting***: Include the sampling weight variables in all files where they make sense. 
   - ***File names***: Name your data (and other) files using names that make them easy to understand.

  - **Prepare the related materials to be included as external resources**
     - Make sure you have a copy of the questionnaire or form in electronic format. Include the original format and a PDF version of it. If the survey was conducted using computer-assisted interviews, using a software like Survey Solutions or CsPro, generate a PDF copy of the electronic form (Survey Solutions provide an otion to generate such a file).
     - Collect an electronic copy of all other relevant documents, such as interviewer manual, technical documentation on sampling, survey technical and analytical report, presentation of results, press releases, etc. If the document is not in PDF format, generate a PDF copy.
     - Collect other digital materials related to the dataset, such as data editing scripts, photos and videos, etc.

## Create a project

The first step in documenting a dataset is to create a new project. You do that by clicking on CREATE NEW PROJECT in the *My projects* page. This will open a new, utitled project page. 

In that page, select the Template you want to use to document the dataset. A default template is proposed. You can switch to another template by clicking on *Switch template* in the **Templates** frame of the *Project home page*. Note that you can at any time change the template used for the documentation of a project. The selected template will determine what you see in the navigation tree and in the metadata entry pages, but switching from one template to another does not impact the metadata that has already been entered. No information will be deleted from the metadata.

See the **Quick start: Microdata** section for a quick overview of the process of documenting a micro-dataset.

## Document the dataset

Once a project has been created, you can start entering metadata and subsequently import the data files (assuming you want to include file and variable-level documentation, which is not mandatory), or you can first import the data then add metadata. The sequence in which you document the dataset does not matter. 

The DDI Codebook metadata standard used to document microdata has the following sections, which will be found in any template designed based on that standard:
- **Document description:** This section contains metadata on the metadata (who documents the dataset, when, etc.)
- **Study description:** This section contains cataloguing and referential metadata that describe the study (survey, census, administrative recording system), with information like title, geographic and temporal coverage, producers and sponsors, etc.
- **File description:** This section provides a brief description of each data file.
- **Variable description:** The section contains the metadata elements used to document each variable, with elements like variable name and label, value labels, literal questions and interviwer instructions, universe, summary statistics, and more.
- **Variable groups:** This optional section provides a way to organize variables into groups other than the data files, This section is intended to increase the convenience to users, and possibly the online discoverability of data (if useful group descriptions are provided).


### Document description

The **Document description** section of the navigation tree contains elements intended to document the metadata being nenerated ("metadata about the metadata"). In the DDI jargon, the *document* is the DDI-compliant metadata file that contains all metadata related to the dataset. This section corresponds to the section **Information on metadata** in other standards. 

ALl content in this section is optional; it is however good practice to document the metadata as precisely as possible. This information will not be useful to data users, but it will be for catalog administrators. When metadata is sghared across catalogs (or automatically harvested), the information entered in the **Document description** provides transparency and clarity on the origin of the metadata.


### Study description

The **Study description** section of the DDI Codebook metadata standard contains the cataloguing and referential metadata. The elements that are required are the unique identifier of the dataset, and its title. Other elements are not required (unless they are decalred as required in a custom-defined template).

The metadata entered for this section should be as comprehensive as possible.

Note that dates should preferably be entered in ISO format (YYYY-MM-DD or YYYY-MM or YYYY).


### Data files

The **Data files** section of the DDI Metadata Editor is where structural metadata will be captured, including file-level and variable-level information. 

***Importing data files***

Typically, structural metadata for microdata will be generated by extracting information from the data files (when no data file is available to be imported, this section will be left empty, or information can be entered manually, which may be a tedious process).

To import data files, select *Data files* in the navigation tree, and click IMPORT in the *Data files* page. Select the file(s) to be imported. The following formats are supported: Stata (.DTA), SPSS (.SAV), ...

The Metadata Editor runs Python in the background (library Pandas). It will read the data, and convert the data files to CSV for internal use. The application will make a best guess for the type of each variable (continuous or categorical), extract variable names and labels, extract value labels, and generate (unweighted) summary statistics for all variables. By doing so, the application will generate a data dictionary for each data file.

The imported data files will now be listed in the navigation tree. Summary information on the imported data files will be displayed in the *Data files* page. 

![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_list_data_files.png)

The CSV version of the data will be stored on the server that hosts the Metadata Editor. If the data are confidential and sensitive, they may be removed from the server at any time. 

**Reordering data files**

If the order in which the files appear in the *Data files* page needs to be modified, use the handle icons to move the files up ir down. This allows you to ensure that the metadata on data files will be displayed in the right order.

**Exporting data files**

At any time, you may export the imported data files, to any of the supported format. Typically, you will want to export the data files AFTER editing the metadata (variable and value labels) to ensure full consistency between the data and the metadata.

**Deleting data files**

Data files can be **deleted** from the project. When you delete a data file, all related metadata will be removed, and the data for the deleted file will be removed from the server. 

**Removing data files from server**

If you want to preserve the metadata on a data file but remove the data from the server, use the **Clear data** option provided in the *Data files* page. Note that after removing the data from the server, you will not be able to update the summary statistics anymore. If you plan to edit the value labels, or apply weights to generate weighted summary statistics, do that BEFORE you clear the files. 

**Replacing data files**

You can replace a data file by selecting the option **Replace file** in the option menu for a data file in the *Data files* page. You can only replace a data file with another data file that has the exact same structure (same variables, in the same order). The application will replace the data, but leave the metadata already entered in the Metadata Editor untouched. Replacing file is thus a solution to refresh the data (and summary statistics) without losing updated metadata.

![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_refresh_replace_data_files.png)

**Refreshing summary statistics**

Some actions on data files (modifying *Categories description* or applying weighting coefficients) will require that the summary statistics be updated. The Metadata Editor does not automatically update statistics each time a change is made. Instead, it will add visual clues that the data does not correspond to the metadata anymore, and call for a refreshing of summary statistics. The *Refresh summary statistics* in the option menu next to the data file description (in the *Data files* page) serves this purpose. Another option to refresh statistics is to click on the **Refresh stats" icon in the *Variable list* frame of the Variable page (see below). 

**File description** 

Clicking on a file name in the navigation tree will open the *File description* page where the information on the data file can be entered.

![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_data_file_description.png)


### Variables

The variable description section of the DDI Codebook standard provides you with a solution to create a very detailed data dictionary. While some of the variable-level metadata will be imported from the data files, the DDI Codebook contains many elements that can enrich the data dictionary. This additional information is very useful both for discoverability and for increased usability of the data. 

After importing a data file in the Metadata Editor, you can access information on the variable it contains by clicking on *Variables* below the file name in the navigation tree. This will open the *Variables* page, which contains four frames: 
- ***Variables:*** This frame provides the list of variables in the data file, with their name and label.
- ***Variable categories:*** This frame described the categories (value labels) for a categorical variable selected in the list of variables.
- ***Variable description:*** This frame contains information on the status and type of the variable selected in the variable list, on its range, and on missing values.
- ***Statistics, weights, documentation, and json:*** This frame is used to edit the documentation of the selected variable(s), select the summary statistics to be included in the metadata, and apply sampling weights if needed.

These four frames are described in detail below.


- **Variable list**

The variable list displays the list of variables in the selected data file, with their name and label. 

![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_variable_list_frame.png)

A search bar is provided to locate variables of interest (keyword search on variable name and label).
   - The variable labels can be edited (double click on the label to edit it). All variables should have a specific label.
   - The variable names cannot be edited.
   - A set of icons provides information on the status of each variable, as follows:

      ![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_variable_list_icons.png)

The icons shown on top of the list allow some actions on variables:
![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_buttons_variable_list.png)

   - ***Refresh stats***
   
   - ***Change case***
     
     ![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_variable_change_case.png)

   - ***Spread metadata***
   
   - ***Delete selection***



- **Variable categories** (value labels)
  
  When the data are imported, if they are detected as being categorical variables, the *Variable categories* will be automatically populated. If value labels are included in the data file, they will be imported. These labels can be edited in the *Variable categories* frame. Codes can also be added if necessary.
  If the categories were not detected when the data were imported, the Metadata Editor provides an option to automatically *Create categories*. This option is accessed by clicking on the icon at the top of the frame. When this icon is clicked, the application will extract a list of all codes found for the variables in the data, and create a list of categories. The labels corresponding to each category can then be added by the data curator. An icon is also provided to *Clear all* categories in the list.

![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_value_labels.png)

Categories can be removed from the list by clicking on the trash icon.

The *Variable categories* frame contains the following icon toolbar:

![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_toolbar_categories.png)

An option is also provided to copy/paste content in the list of value labels. This allows for example to copy code lists from an application like MS-Excel and to paste them in the *Variable categories* grid. The pasted information can either *replace* existing content of the grid (if any), or *append* content to it.  

![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_value_labels_copy_paste_access.png)

![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_value_labels_copy_paste_menu.png)

- **Variabe information**

![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_variable_information.png)

   - ***Is weight***

    ![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_weights.png)

   - ***Interval type***
     Continuous or discrete

   - ***Type***
     Numeric, character, fixed

   - ***Min, Max, and Decimal point***
     
   - ***Missing***
  
- Import metadata from existing file (use case: DDI from Survey Solutions; similar survey)
- Apply default


- **Variable documentation**

  ![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_variable_documentation_frame.png)

   ***Toolbar***

  ![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_navigate_variables.png)

   ***Settings***

   ***Statistics***

  ![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_variable_statistics.png)

   ***Weights***

  ![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_variable_documentation_weights.png)

   ***Documentation***

   ![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_variable_documentation_documentation.png)

   ***JSON***

  ![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_variable_documentation_json.png)


**View data**

The Metadata Editor allows you to view the content of the data files, by clicking on "Data" under the data file name in the navigation tree. You can view and export the data from this page, but you cannot edit the data. The Metadata Editor is not a data editor; changes to the data files must be made outside the Metadata Editor.

![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_variable_view_data.png)



### Variable groupings

Purpose
How to

![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_variable_groups_create.png)

![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_variable_groups_select_item.png)

![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_variable_groups_selection.png)

### Provenance ###


### External resources
- Recommendations
- How to add
- Specific case of microdata
- Format for microdata

### Importing metadata ###

![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_import_metadata_menu_access.png)

![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_import_metadata_menu.png)

![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_variable_import_project_metadata.png)


### Spreading metadata ###

![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_spread_metadata_icon.png)

![image](https://github.com/mah0001/metadata-editor-docs-v2/blob/main/img/ME_UG_v1-0-0_documenting_microdata_variable_spread_metadata.png)

### Diagnostic


### Export metadata


### Publish metadata ###



